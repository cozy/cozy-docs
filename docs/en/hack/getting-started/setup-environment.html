<!DOCTYPE html><!--[if lte IE 7]> <html class="no-js ie67 ie678" lang="en"> <![endif]-->
<!--[if IE 8]> <html class="no-js ie8 ie678" lang="en"> <![endif]-->
<!--[if IE 9]> <html class="no-js ie9" lang="en"> <![endif]-->
<html lang="en">
  <head>
    <meta charset="utf-8"><!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <link rel="shortcut icon" href="/assets/images/favicon.png">
    <title>Setting up the environment
    </title><link  rel="stylesheet" href="/cozy-docs/vendors/css/knacss.css" /><link  rel="stylesheet" href="/cozy-docs/vendors/css/sunburst.css" /><link  rel="stylesheet" href="/assets/css/main.css" />
  </head>
  <body>
    <div class="navbar fixed"><a href="/en/" class="nav-logo"><img src="/assets/images/cozy-logo-docs.svg"></a>
      <ul class="subtitle">
        <li><a href="/en/hack/getting-started/" class="selected">Getting started</a>
          <ul class="dropdown-menu">
            <li><a href="/en/hack/getting-started/setup-environment.html">Setting up the environment</a></li>
            <li><a href="/en/hack/getting-started/first-app.html">Your first app in 30 minutes</a></li>
            <li><a href="/en/hack/getting-started/architecture-overview.html">Understand the Cozy Architecture</a></li>
            <li><a href="/en/hack/getting-started/play-with-data-system.html">Play with the Data System</a></li>
            <li><a href="/en/hack/getting-started/discover-americano.html">Discover Americano</a></li>
            <li><a href="/en/hack/getting-started/learn-single-page-app-way.html">Learn the Single Page App Way</a></li>
          </ul>
        </li>
        <li><a href="/en/hack/cookbooks/">Cookbooks</a>
          <ul class="dropdown-menu">
            <li><a href="/en/hack/cookbooks/data-system.html">The Data System API</a></li>
            <li><a href="/en/hack/cookbooks/controller.html">The Controller API</a></li>
            <li><a href="/en/hack/cookbooks/data-system-odm.html">The ODM for Data System API</a></li>
            <li><a href="/en/hack/cookbooks/understanding-dev-environment.html">Understanding Cozy's development environment</a></li>
            <li><a href="/en/hack/cookbooks/deploy.html">Deploy your application</a></li>
            <li><a href="/en/hack/cookbooks/localization.html">Localize your applications</a></li>
            <li><a href="/en/hack/cookbooks/debugging.html">Debug your application</a></li>
            <li><a href="/en/hack/cookbooks/debugging-production.html">Debug in production environment</a></li>
            <li><a href="/en/hack/cookbooks/nodemon-server-auto-refresh-on-change.html">Using nodemon to auto-refresh the server on code change</a></li>
            <li><a href="/en/hack/cookbooks/connect-a-device.html">Connect a device to a Cozy</a></li>
            <li><a href="/en/hack/cookbooks/components.html">Components</a></li>
            <li><a href="/en/hack/cookbooks/authentication-authorization-workflows.html">Authentication and Authorization workflows</a></li>
            <li><a href="/en/hack/cookbooks/encryption.html">Encryption management</a></li>
          </ul>
        </li>
        <li><a href="/en/hack/application-skeletons/">Application Skeletons</a>
          <ul class="dropdown-menu">
            <li><a href="/en/hack/application-skeletons/cozy-official.html">Official Cozy skeleton</a></li>
          </ul>
        </li>
        <li><a href="/en/hack/contributing/">Contributing</a>
        </li>
        <li><a href="/en/hack/releases/">Releases</a>
          <ul class="dropdown-menu">
            <li><a href="/en/hack/releases/patch-notes-17.html">Patch notes 2015/12/02</a></li>
            <li><a href="/en/hack/releases/patch-notes-18.html">Last release note</a></li>
          </ul>
        </li>
      </ul>
      <ul class="navigation">
        <li><a href="/en/host/install/">Install</a>
        </li>
        <li><a href="/en/mobile/files.html">Sync</a>
        </li>
        <li><a href="https://dev.cozy.io" class="selected">Dev</a>
        </li>
      </ul>
    </div>
    <div class="wrapper">
      <div id="main" role="main" class="mod pam selected"><h1 id="setting-up-the-environment">Setting up the environment</h1>
<p>Welcome to the first step: setting up your development environment.</p>
<p>Since Cozy is made from several pieces, we wrapped it into an easy-to-use
virtual machine, so you don&#39;t clutter your local system. That also means you can
use the operation system you like! (Well, there are obviously issues on Windows).</p>
<h2 id="installing-dependencies">Installing dependencies</h2>
<p>Before doing anything, install the following:</p>
<h3 id="for-simple-applications">For simple applications</h3>
<h4 id="node-js-v4-3-a-href-https-nodejs-org-en-download-target-_blank-download-a-">Node.js (v4.3) (<a href="https://nodejs.org/en/download/" target="_blank">download</a>)</h4>
<p>Node.js powers awesome tools that we use to develop apps. We also wrote a tool
to manage the virtual machine more easily.
If you have trouble installing NodeJS on your system, check the <a href="https://github.com/joyent/node/wiki/Installing-Node.js-via-package-manager">official guide</a>.</p>
<p>If you already have NodeJS installed, but not the 4.3 version, you can use a version manager like <a href="https://github.com/tj/n">https://github.com/tj/n</a>.</p>
<h4 id="git-a-href-http-git-scm-com-book-en-getting-started-installing-git-target-_blank-download-a-">Git (<a href="http://git-scm.com/book/en/Getting-Started-Installing-Git" target="_blank">download</a>)</h4>
<p>Git is a version control tool that is now very common. We use it in combination
with <a href="https://github.com">Github</a>, which allows you to store your repository online
and much more!</p>
<p>If you don&#39;t want access to the specific features of Cozy Cloud, you can stop
here and jump to our <a href="/en/hack/getting-started/first-app.html">first tutorial</a>.</p>
<h3 id="for-applications-that-take-advantage-of-the-data-system">For applications that take advantage of the Data System</h3>
<h4 id="virtualbox-v4-3-0-a-href-https-www-virtualbox-org-wiki-downloads-target-_blank-download-a-">VirtualBox (&gt;= v4.3.0) (<a href="https://www.virtualbox.org/wiki/Downloads" target="_blank">download</a>)</h4>
<p>Virtual Box allows you to run virtual machines on your computer. We use it
indirectly with Vagrant to power our virtual machine.
(Latest tested version: 4.3.0)</p>
<h4 id="vagrant-v1-7-1-a-href-https-www-vagrantup-com-downloads-html-target-_blank-download-a-">Vagrant (= v1.7.1) (<a href="https://www.vagrantup.com/downloads.html" target="_blank">download</a>)</h4>
<p>Vagrant is a tool to &quot;create and configure lightweight, reproducible and
portable development environments.&quot; That&#39;s what we need here! We use it through
a custom CLI tool, so you will not manipulate it directly.
(Latest tested version: 1.7.2)</p>
<h4 id="-cozy-for-developers-https-github-com-cozy-cozy-dev-"><a href="https://github.com/cozy/cozy-dev">Cozy for developers</a></h4>
<p>You will also need our tool:</p>
<pre class="highlight"><code class="hljs bash">sudo npm install -g cozy-dev
</code></pre>
<p>The <code>cozy-dev</code> tool will allow you to create and manage a virtual machine with a Cozy development environment, without dealing yourself with VirtualBox and Vagrant. Also, it can generate application skeletons from templates.</p>
<h4 id="-coffeelint-http-www-coffeelint-org-optional-"><a href="http://www.coffeelint.org/">CoffeeLint</a> (optional)</h4>
<p>You might want to install CoffeeLint to check that your .coffee scripts follow <a href="https://github.com/cozy/cozy-guidelines/#cozy-code-guidelines">Cozy&#39;s guidelines</a>:</p>
<pre class="highlight"><code class="hljs bash">npm install -g coffeelint
</code></pre>
<h3 id="initializing-and-starting-the-virtual-machine">Initializing and starting the virtual machine</h3>
<p>The next step is to get your virtual machine. Basically, you are going to
have a Linux-based OS running on your computer with all a Cozy needs to work already
installed and configured.</p>
<p>To help you managing the VM, the Cozy Manager comes to the rescue.</p>
<p>Create a folder that will contain all your source code:</p>
<pre class="highlight"><code class="hljs bash">mkdir cozy &amp;&amp; <span class="hljs-built_in">cd</span> cozy
</code></pre>
<p>Now you can use the Cozy Manager to initialize the VM by running:</p>
<pre class="highlight"><code class="hljs bash">cozy-dev vm:init
</code></pre>
<p>This will download the base box file (~500MB) and a custom configuration
(<a href="https://github.com/cozy/cozy-setup/blob/master/dev/Vagrantfile">see it on Github</a>).
Then the VM will be created. The whole process will take about 5-10 minutes
(depending on your internet connection and your computer).</p>
<p>Then you can start the VM and check that everything is running correctly.</p>
<pre class="highlight"><code class="hljs bash">cozy-dev vm:start
cozy-dev vm:status
</code></pre>
<p>We advise you to update the VM the first time you start it (and regularly after that),
because we don&#39;t update the base box each time we improve or fix a bug in the
Cozy platform:</p>
<pre class="highlight"><code class="hljs bash">cozy-dev vm:update
</code></pre>
<p>This will just update the software within the running VM, it won&#39;t download anything and all your data will be kept.</p>
<p>You can go to <code>http://localhost:9104/</code> in order to see your Cozy running. You can use it, but beware! The Cozy running in your virtual machine is in development mode, meaning that most of the security measures are disabled. Only use it for
testing purposes.</p>
<p>You can find everything you need to know about <code>cozy-dev</code> in <a href="/en/hack/cookbooks/understanding-dev-environment.html#deploy">the cookbook</a>, but we will introduce the concepts as we go in the next steps of the tutorial.
You are now ready to <a href="/en/hack/getting-started/first-app.html">write your first application</a>.</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="my-vm-is-not-starting-and-says-there-s-an-error">My VM is not starting and says there&#39;s an error</h3>
<p>The first thing to try is update the VM with cozy-dev: <code>cozy-dev vm:update</code></p>
<p>It will fetch the last changes and may fix some problems. Then you can try to start your VM again with <code>cozy-dev vm:start</code></p>
<h3 id="my-vm-is-not-starting-and-says-verr_zip_corrupted-">My VM is not starting and says &quot;VERR_ZIP_CORRUPTED&quot;</h3>
<p>Try running <code>vagrant box remove cozycloud/cozy-dev</code> and then re-running <code>cozy-dev vm:init</code>.</p>
<h3 id="my-vm-displays-a-lot-of-ssh-timeout-">My VM displays a lot of &#39;SSH Timeout&#39;</h3>
<p>That can be &quot;normal&quot;. It occurs when the network is not yet configured on the VM.
You can force Virtual Box to open its GUI and check what is happening.</p>
<p>Stop the vm with <code>cozy-dev vm:stop</code>, then open the <code>Vagrantfile</code>.</p>
<p>There should already be a block delimited by <code>config.vm.provider :virtualbox do |vb|</code> and <code>end</code>. If there is, just paste this inside: <code>vb.gui = true</code>.</p>
<p>If there is not, look for where it says <code>Vagrant.configure(&quot;2&quot;) do |config|</code>
and underneath that, paste this:</p>
<pre class="highlight"><code class="hljs ruby">config.vm.provider <span class="hljs-symbol">:virtualbox</span> <span class="hljs-keyword">do</span> <span class="hljs-params">|vb|</span>
  vb.gui = <span class="hljs-literal">true</span>
<span class="hljs-keyword">end</span>
</code></pre><p>You can now run <code>cozy-dev vm:start</code> and have the Virtual Box GUI. What you may see in this case is the VM displaying &quot;Waiting 60 more seconds for network configuration&quot;. Just be patient. It should work by itself and display the login prompt after a bit.
Once the login prompt appears, you will be able to go back to your terminal and connect to the vm with <code>vagrant ssh</code>.</p>
<p>Once connected, you will be allowed to check the status with <code>cozy-monitor status</code> and start the applications down.</p>
<h3 id="it-still-doesn-t-work">It still doesn&#39;t work</h3>
<p>If your application only need access to the data-system, you can clone the data-system repository and use it standalone.
You&#39;ll need to install couchdb along with its dependencies.</p>
<pre class="highlight"><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/cozy/cozy-data-system.git
<span class="hljs-built_in">cd</span> cozy-data-system
npm install
coffee server.coffee
</code></pre>
<p>Your data-system should now run, you can now build your app and access it.
Here&#39;s an example with the cozy-calendar repo:</p>
<pre class="highlight"><code class="hljs bash"><span class="hljs-built_in">cd</span> cozy-calendar
npm install
coffee server.coffee
</code></pre>
<p>then head to <code>http://127.0.0.1:9113</code></p>

      </div>
      <footer id="footer" role="contentinfo"><a href="https://github.com/cozy"><img src="/assets/images/icons/icon-github.svg">Github</a><a href="irc://irc.freenode.net/cozycloud"><img src="/assets/images/icons/icon-message.svg">IRC</a><a href="https://forum.cozy.io"><img src="/assets/images/icons/icon-smiley.svg">Forum</a><a href="mailto:contact@cozycloud.cc"><img src="/assets/images/icons/icon-mail.svg">Contact</a><a href="https://www.cozy.io"><img src="/assets/images/icons/icon-cloud.svg">Cozy's site</a></footer>
    </div><script defer="defer"  src="/cozy-docs/vendors/javascripts/jquery-2.0.3.min.js"></script><script defer="defer"  src="/cozy-docs/vendors/javascripts/bootstrap.min.js"></script><script defer="defer"  src="/assets/javascripts/main.js"></script>
    <script type="text/javascript">
      var _paq = _paq || [];
      _paq.push(['disableCookies']);
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
      var u="//piwik.cozycloud.cc/";
      _paq.push(['setTrackerUrl', u+'piwik.php']);
      _paq.push(['setSiteId', 7]);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
    <noscript>
      <p><img src="https://piwik.cozycloud.cc/piwik.php?idsite=7" style="border:0" alt=""></p>
    </noscript>
  </body>
</html>